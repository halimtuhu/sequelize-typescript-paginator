{"version":3,"file":"index.js","sourceRoot":"/","sources":["index.ts"],"names":[],"mappings":";;AAGA,MAAa,cAAc;CAK1B;AALD,wCAKC;AAED,MAAa,kBAAkB;CAG9B;AAHD,gDAGC;AAED,MAAa,kBAAkB;IAC7B,MAAM,CAAC,KAAK,CAAC,QAAQ,CACnB,KAAmB,EACnB,OAAuB,EAAE,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,EAC/C,UAAyC,EAAE;QAE3C,OAAO,OAAO,CAAC,KAAK,CAAC;QACrB,OAAO,OAAO,CAAC,MAAM,CAAC;QAEtB,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;QAEtD,MAAM,KAAK,GAAG,MAAM,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QACzC,MAAM,KAAK,GAAG,MAAM,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC3C,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAErB,OAAO;YACL,IAAI,EAAE,KAAK;YACX,IAAI,EAAE;gBACJ,OAAO,EAAE,IAAI,CAAC,OAAO;gBACrB,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;gBAC1C,KAAK,EAAE,KAAK;aACb;SACF,CAAC;IACJ,CAAC;CACF;AA1BD,gDA0BC","sourcesContent":["import { Model, ModelCtor } from \"sequelize-typescript\";\nimport { FindOptions } from \"sequelize/types\";\n\nexport class PaginationMeta {\n  perPage: number;\n  page: number;\n  totalPage?: number;\n  total?: number;\n}\n\nexport class PaginationResponse<T> {\n  data: Array<T>;\n  meta: PaginationMeta;\n}\n\nexport class SequelizePaginator {\n  static async paginate<M extends Model>(\n    model: ModelCtor<M>,\n    meta: PaginationMeta = { perPage: 10, page: 1 },\n    options: FindOptions<M[\"_attributes\"]> = {}\n  ): Promise<PaginationResponse<M>> {\n    delete options.limit;\n    delete options.offset;\n\n    options.limit = meta.perPage;\n    options.offset = (meta.page - 1) * (meta.perPage + 1);\n\n    const total = await model.count(options);\n    const items = await model.findAll(options);\n    console.log(options);\n\n    return {\n      data: items,\n      meta: {\n        perPage: meta.perPage,\n        page: meta.page,\n        totalPage: Math.ceil(total / meta.perPage),\n        total: total,\n      },\n    };\n  }\n}\n"]}